@model ProductDetailsModel
@using System.Globalization
@using Nop.Core.Domain.Catalog
@using Nop.Services.Helpers
@inject CatalogSettings catalogSettings
@inject IUserAgentHelper userAgentHelper
@if (Model.IsRental)
{
<div class="attributes rental-attributes">
    <script language="javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <!---*** End: JQuery 3.3.1 version. ***--->
    <!---*** Start: Bootstrap 3.3.7 version files. ***--->
    <script language="javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <!---*** End: Bootstrap 3.3.7 version files. ***--->

    <script language="javascript" src="https://momentjs.com/downloads/moment.js"></script>
    <script language="javascript" src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.43/js/bootstrap-datetimepicker.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.43/css/bootstrap-datetimepicker.min.css">



    @{
        var startDateControlId = $"rental_start_date_{Model.Id}";
        var endDateControlId = $"rental_end_date_{Model.Id}";
        //currenly we support only this format
        //java-script format
        const string datePickerFormat = "DD/MM/YYYY hh:mm A";
        //C# format for ToString method
        const string datePickerFormat2 = "MM/dd/yyyy";
        var isMobileDevice = userAgentHelper.IsMobileDevice();

      
        <div class="attribute-item">
            <div class="attribute-label">
                <label class="text-prompt">
                    @T("Products.RentalStartDate"):
                </label>
                <span class="required">*</span>
            </div>
            <div class="attribute-data">
                
                <input id="@(startDateControlId)" name="@(startDateControlId)" type="text" class="datepicker" value="@(Model.RentalStartDate.HasValue ? Model.RentalStartDate.Value.ToString(datePickerFormat2, CultureInfo.InvariantCulture) : null)" @if (isMobileDevice) { <text> readonly</text>} />
                <script asp-location="Footer">
                    $(document).ready(function () {
                       

                        $("#@(startDateControlId)").datetimepicker({ format: "@datePickerFormat" }).on("dp.change", function () {
                            RentalDatePickerSelect;
                        });
                        });
                </script>
            </div>
        </div>
        <div class="attribute-item">
            <div class="attribute-label">
                <label class="text-prompt">
                    @T("Products.RentalEndDate"):
                </label>
                <span class="required">*</span>
            </div>
            <div class="attribute-data">
                <input id="@(endDateControlId)" name="@(endDateControlId)" type="text" class="datepicker" value="@(Model.RentalEndDate.HasValue ? Model.RentalEndDate.Value.ToString(datePickerFormat2, CultureInfo.InvariantCulture) : null)" @if (isMobileDevice) { <text> readonly</text>} />
                <script asp-location="Footer">
                        $(document).ready(function () {
                            $("#@(endDateControlId)").datetimepicker({ format: "@datePickerFormat" }).on("dp.change", function () {
                                RentalDatePickerSelect ;
                            });
                        });
                </script>
            </div>
        </div>
    }

    <script asp-location="Footer">
            function onRentalDatePickerSelect() {
                @{
                    //almost the same implementation is used in the \Views\Product\_ProductAttributes.cshtml file
                    var productId = Model.Id;
                    if (catalogSettings.AjaxProcessAttributeChange)
                    {
                        <text>
                        $.ajax({
                            cache: false,
                            url: '@Html.Raw(Url.Action("productdetails_attributechange", "shoppingcart", new {productId = productId, validateAttributeConditions = false, loadPicture = false }))',
                            data: $('#product-details-form').serialize(),
                            type: 'post',
                            success: function(data) {
                                if (data.sku) {
                                    $('#sku-@productId').text(data.sku);
                                }
                                if (data.mpn) {
                                    $('#mpn-@productId').text(data.mpn);
                                }
                                if (data.gtin) {
                                    $('#gtin-@productId').text(data.gtin);
                                }
                                if (data.price) {
                                    $('.price-value-@productId').text(data.price);
                                }
                            }
                        });
                        </text>
                    }
                }
            }
    </script>
</div>
}